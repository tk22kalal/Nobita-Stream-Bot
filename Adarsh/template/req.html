<!--(c) NobiDeveloper-->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta property="og:image" content="https://graph.org/file/5e6d18610741226005e6e.jpg" itemprop="thumbnailUrl">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="monetag" content="f3ecc71ccb639ccf66d9d0dee93d3e7a">
    <title>{{ file_name }}</title>
    <link rel="stylesheet" type='text/css' href="https://drive----google.com/uc?export=view&id=1pVLG4gZy7jdow3sO-wFS06aP_A9QX0O6">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Raleway">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Delius">
    <link rel="stylesheet" href="https://cdn.plyr.io/3.6.9/plyr.css" />

    <style>
        marquee {
            font-size: 30px;
            font-weight: 800;
            color: Black;
            font-family: serif;
        }
    </style>
    <meta name='dmca-site-verification' content='THBkdGsyeW85ZTBMT3VZNHpteGkvWEtoV3h5NENqcDdPa2hsUzZiU0ZZST01' />
</head>

<body>

    <header>
        <marquee bgcolor="#fff">
            <div class="toogle"></div>
            <div id="file-name">
                {{ file_name }}
            </div>
        </marquee>
    </header>

    <div class="container">
        <{{ tag }} src="{{ file_url }}" class="player"></{{ tag }}>
    </div>


<script src="https://cdn.plyr.io/3.6.9/plyr.js"></script>
<script src="https://cdn.jsdelivr.net/npm/hls.js@latest"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
    const playerElement = document.querySelector('.player');
    if (!playerElement) return;

    const source = playerElement.getAttribute('src');
    let player, hls;

    function forcePlayAfterSeek() {
        // Always try to play immediately after seeking
        player.play().catch(() => {});
        // For HLS, ensure buffer ahead after seek
        if (hls) {
            hls.startLoad(player.currentTime);
            // Optionally, nudge buffering
            if (typeof hls.swapAudioCodec === 'function') hls.swapAudioCodec();
            if (typeof hls.currentLevel === 'number' && typeof hls.nextLevel === 'number')
                hls.currentLevel = hls.nextLevel;
        }
    }

    function initPlyr() {
        player = new Plyr(playerElement, {
            controls: [
                'play-large', 'rewind', 'play', 'fast-forward', 'progress',
                'current-time', 'duration',
                'settings', 'pip', 'airplay', 'fullscreen'
            ],
            preload: 'metadata',
            playsinline: true,
            seekTime: 10
        });

        // Force play after seek
        player.on('seeked', forcePlayAfterSeek);

        // Also try to force play after 'seeking' (some browsers emit only this event)
        player.on('seeking', forcePlayAfterSeek);
    }

    if (playerElement.tagName.toLowerCase() === 'video') {
        if (source.endsWith('.m3u8')) {
            if (Hls.isSupported()) {
                hls = new Hls({
                    maxBufferLength: 60,
                    maxMaxBufferLength: 120,
                    startLevel: -1,
                    enableWorker: true,
                    lowLatencyMode: true,
                });
                hls.loadSource(source);
                hls.attachMedia(playerElement);

                hls.on(Hls.Events.MANIFEST_PARSED, () => {
                    initPlyr();
                });

                hls.on(Hls.Events.ERROR, (event, data) => {
                    console.error('HLS error:', data);
                });
            } else if (playerElement.canPlayType('application/vnd.apple.mpegurl')) {
                playerElement.src = source;
                initPlyr();
            }
        } else {
            // MP4 or direct video
            initPlyr();
        }
    } else {
        // For audio or others
        initPlyr();
    }
});
</script>
    
</body>
</html>   
